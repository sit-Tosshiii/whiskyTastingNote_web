# Whisky Tasting Note | プロダクト要件整理

## 1. プロジェクト概要
- スマートフォン利用を主軸にした個人向けテイスティングノート PWA。
- オフライン利用・ホーム画面追加・通知などモバイルライクな体験を目指す。
- 将来的な収益化はアフィリエイトとブランド協業を想定。

## 2. 想定ユーザーと利用シナリオ
- 自分用のウイスキーメモを継続的に残したい個人ユーザー。
- ログイン後にノートを登録 → 一覧で検索・編集・削除 → 後で読み返す、が基本導線。

## 3. 現在実装済み / 優先機能
- **認証**
  - メール+パスワードでの登録・ログインを提供。セッションはサーバーサイドで検証。
- **テイスティングノート管理（CRUD）**
  - 入力項目：銘柄名（必須）、蒸留所名（和/英を統合入力）、産地、香り、味わい、総合コメント、総合スコア（0–100）、アルコール度数（0–100）、樽、画像1枚。
  - 一覧画面から直接編集・削除が可能。編集は専用ページで既存値を読み込み、バリデーションを共通化。
- **検索・閲覧**
  - 自分のノートを最新順で一覧表示。
  - 銘柄・蒸留所・産地・メモ内容・ABV・画像パスをキーワード検索で横断的にフィルタ。
- **データ投入支援**
  - JSON からの一括取り込みスクリプトを用意（ランダムなABV/樽値を付与し、対象ユーザーに登録）。

## 4. 進行中 / 今後の機能検討
- PWA 機能（オフラインキャッシュ、プッシュ通知）を本番想定で検証。
- ノート共有、公開プロフィール、レコメンド表示などコミュニティ的機能。
- Word2Vec / PCA / k-NN を使った嗜好分析とレコメンド API の本格導入。
- 収益用のリンク管理・成果計測、ブランドタイアップメニュー。

## 5. 非機能要件と運用方針
- **UX / UI**: スマホ向けレスポンシブを最優先。暗色基調のUIを継続。
- **セキュリティ**: HTTPS 前提、JWT クッキーの保護、画像アップロード5MB制限。
- **信頼性**: Postgres バックアップ、画像ファイル削除の整合性、障害時復旧手順の整備。
- **パフォーマンス**: 検索はユーザー範囲に限定し、インデックスを活用。画像はローカル保存→将来的にCDNへ移行。

## 6. 収益化のアイデア整理
- **アフィリエイト**
  - 強み: 初期導入が容易、嗜好データとの連携で訴求性が高い。
  - 注意点: トラフィック獲得、SKU 正規化、外部リンクのメンテナンス。
- **スポンサー / コラボ広告**
  - 強み: 1案件あたりの単価が高く、分析レポートと組み合わせやすい。
  - 注意点: 営業工数と開発調整コスト、UX への影響。

## 7. 技術スタックとアーキテクチャ方針
- **フロントエンド**: Next.js (App Router) + TypeScript、Emotion なしのプレーンCSS。フォームは自作バリデーションで共通化。
- **サーバー / データ**: ローカルでは Docker Compose + Postgres。マイグレーションは `database/migrations` と Supabase 互換 SQL を併走。
- **分析 API**: Python (FastAPI) サービスを別コンテナで起動。将来的にモデル推論を実装。
- **CI/CD**: GitHub Actions 導入予定。Lint、型チェック、PWA ビルド確認を自動化。
- **監視とロギング**: Sentry / Logflare / GA4 を候補とし、アプリ/分析APIのエラー監視を想定。

## 8. 今後のタスク例
- テイストノートのタグ付け、ブックマーク、エクスポート機能の検討。
- Supabase への本格移行（RLS 設計、Edge Functions 連携）。
- プッシュ通知やホーム画面追加など PWA 要素の実装。
- 収益計測用の KPI 整備とダッシュボード検討。
